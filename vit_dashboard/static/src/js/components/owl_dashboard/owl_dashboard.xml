<?xml version="1.0" encoding="UTF-8" ?>
<templates>
    <t t-name="vit_dashboard.OWLDashboard" owl="1">
        <Layout display="display" className="'o_dashboard h-100'">

            <!-- filter-->
            <div class="row px-3 py-2">
                <div class="col-12 col-md-3">
                    <h1>Dashboard</h1>
                    <h3>
                        <t t-if="state.selectedPartner">
                            Partner: <t t-esc="state.selectedPartner.name"/>
                        </t>
                    </h3>                    
                </div>
                
                <div class="col-12 col-md-3">
                    <div class="form-control px-1 m-0" >
                        <PartnerSelector
                            value="state.selectedPartner?.name || ''"
                            onPartnerSelected.bind="onPartnerSelected"
                        />
                    </div>
                </div>         
                <div class="col-12 col-md-3">
                    <LocationSearch
                        value="state.location || ''"
                        onLocationSearchEnter.bind="onLocationSearchEnter"/>
                </div>
                <div class="col-12 col-md-3">
                    <KeywordSearch
                        value="state.keyword || ''"
                        onKeywordSearchEnter.bind="onKeywordSearchEnter"/>
                </div>
                <div class="col-12 col-md-1">
                    <button class="btn btn-secondary" t-on-click="clearSavedState">
                        Reset
                    </button>
                </div>
            </div>

            <!-- content scrollable-->
            <div class="row mx-3 scrollable-row">

                <!-- numer cards -->
                <div class="row">
                    <div class="col"> <!-- Added ms-3 for left margin -->
                        <NumberCard 
                            title="'Sales Order'" 
                            bgColor="'bg-success'" 
                            field="'total_sale_order'"
                            model="'sale.order'"
                            domain="[]" 
                            context="{'search_default_group_by_name': 1}"
                            icon="'fa fa-users'"
                            onReload.bind="onNumberCardReload1"
                        />
                    </div>
                    <div class="col"> <!-- Kept the second NumberCard in the same row -->
                        <NumberCard 
                            title="'Purchase Order'" 
                            field="'total_purchace_order'"
                            model="'purchase.order'"
                            domain="[]"
                            onReload.bind="onNumberCardReload2"
                            bgColor="'bg-warning'"/>
                    </div>
                    <div class="col"> <!-- Added ms-3 for left margin -->
                        <NumberCard 
                            title="'Sales Invoice'" 
                            bgColor="'bg-primary'" 
                            field="'total_sale_order_mou'"
                            model="'account.move'"
                            domain="[['move_type','=','out_invoice']]"
                            onReload.bind="onNumberCardReload3"
                            icon="'fa fa-users'"/>
                    </div>
                    <div class="col"> <!-- Kept the second NumberCard in the same row -->
                        <NumberCard 
                            title="'Vendor Bills'" 
                            field="'total_sale_order_moa'"
                            model="'account.move'"
                            domain="[['move_type','=','in_invoice']]"
                            onReload.bind="onNumberCardReload4"
                            bgColor="'bg-info'"/>
                    </div>
                   
                </div>

                <!-- pie chart -->
                <div class="row py-3">
                    <div class="col-md-3">
                        <MyChart 
                            type="'pie'"                                
                            title="'Status SO'" 
                            model="'sale.order'"
                            domain="[]"
                            field="'total_sale_order_by_state'"
                            context="{'search_default_group_by_state': 1}"
                            onReload.bind="onPieChartReload1"
                            colorIndex="1"
                        />
                    </div>
                
                    <div class="col-md-3">
                        <MyChart 
                            type="'pie'"                                
                            title="'Status PO'" 
                            model="'purchase.order'"
                            domain="[]"
                            context="{'search_default_group_by_state': 1}"
                            field="'total_purchase_order_by_state'"
                            onReload.bind="onPieChartReload2"
                            colorIndex="2" 
                        />
                    </div>

                    <div class="col-md-3">
                        <MyChart 
                            type="'pie'"                                
                            title="'Status Invoice'" 
                            model="'account.move'"
                            domain="[['move_type','=','out_invoice']]"
                            context="{'search_default_group_by_state': 1}"
                            field="'total_account_move_by_stage'"
                            default_views="'kanban'"
                            onReload.bind="onPieChartReload3"
                            colorIndex="4"
                        />
                    </div>
                    <div class="col-md-3">
                        <MyChart 
                            type="'pie'"                                
                            title="'Status Vendor Bills'" 
                            model="'account.move'"
                            domain="[['move_type','=','in_invoice']]"
                            context="{'search_default_group_by_state': 1}"
                            field="'total_account_move_by_stage'"
                            onReload.bind="onPieChartReload4"
                        />
                    </div>
                </div>

                <!-- cal heat map and bar chart -->
                <div class="row mt-3 mb-3">
                    <div class="col-12 col-md-4">
                        <!-- <CalHeatMap title="SO"/> -->
                        <MyChart 
                            type="'bar'"
                            title="'SO per Bulan'" 
                            model="'sale.order'"
                            domain="[]"
                            context="{'search_default_group_by_month': 1}"
                            field="'total_sale_order_by_month'"
                            onReload.bind="onPieChartReload5"
                            colorIndex="1"
                        />
                    </div>   
                    <div class="col-12 col-md-4">
                        <MyChart 
                            type="'bar'"
                            title="'SO per Country'" 
                            model="'sale.order'"
                            domain="[]"
                            context="{'search_default_group_by_country_id': 1}"                           
                            field="'total_sale_order_by_country'"
                            onReload.bind="onPieChartReload6"
                            colorIndex="1"
                        />
                    </div>
                    <div class="col-12 col-md-4">
                        <MyChart 
                            type="'bar'"
                            title="'SO per Tahun'" 
                            model="'sale.order'"
                            domain="[]"
                            context="{'search_default_group_by_year': 1}"
                            field="'total_sale_order_by_year'"
                            onReload.bind="onPieChartReload7"
                            colorIndex="2"
                        />
                    </div>
                </div> 

                <!-- list and maps -->
                <div class="row py-3">
                    <div class="col-12 col-md-4">
                        <ListCard 
                            style="'height: 600px; overflow-y: auto;'"
                            title="'Sale Order'" 
                            field="'list'"
                            fields="['name', 'amount_total', 'partner_id', 'state']"
                            model="'sale.order'"
                            onReload.bind="onListCardReload"
                        />
                    </div>

                    <div class="col-12 col-md-8" >
                        <GoogleMap 
                            domain="[]"
                            model="'res.partner'"
                            onReload.bind="onGoogleMapReload"
                        />
                    </div>
                </div>

            </div>
        </Layout>
    </t>
</templates>